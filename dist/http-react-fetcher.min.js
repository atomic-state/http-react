/**
 * @license http-react-fetcher
 * Copyright (c) Dany Beltran
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ var __rest=this&&this.__rest||function(b,e){var d={};for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&0>e.indexOf(a)&&(d[a]=b[a]);if(null!=b&&"function"==typeof Object.getOwnPropertySymbols)for(var c=0,a=Object.getOwnPropertySymbols(b);c<a.length;c++)0>e.indexOf(a[c])&&Object.prototype.propertyIsEnumerable.call(b,a[c])&&(d[a[c]]=b[a[c]]);return d};function createRequestFn(a,b,c){return async function(e,m={}){let{default:j,resolver:n=a=>a.json(),config:o={},onResolve:p=()=>{},onError:k=()=>{}}=m,{headers:q={},body:f,formatBody:i}=o,g={method:a,headers:Object.assign(Object.assign({"Content-Type":"application/json"},c),q),body:(null==a?void 0:a.match(/(POST|PUT|DELETE|PATCH)/))?"function"==typeof i?i((FormData,f)):!1===i||"undefined"!=typeof FormData&&f instanceof FormData?f:JSON.stringify(f):void 0},h;try{let d=await fetch(`${b||""}${e}`,g);h=d;let l=await n(d);if((null==d?void 0:d.status)>=400)return k(!0),{res:d,data:j,error:!0,code:null==d?void 0:d.status,config:Object.assign({url:`${b||""}${e}`},g)};return p(l,d),{res:d,data:l,error:!1,code:null==d?void 0:d.status,config:Object.assign({url:`${b||""}${e}`},g)}}catch(r){return k(r),{res:h,data:j,error:!0,code:null==h?void 0:h.status,config:Object.assign({url:`${b||""}${e}`},g)}}}}const FetcherContext=React.createContext({defaults:{}}),Fetcher=({url:g="/",default:h,config:a={method:"GET",headers:{},body:{}},children:b,onError:i=()=>{},onResolve:j=()=>{},refresh:c=0})=>{let[d,k]=useState(h),[e,l]=useState(null),[f,m]=useState(!0);async function n(){var b;try{let c=await fetch(g,{method:a.method,headers:Object.assign({"Content-Type":"application/json"},a.headers),body:(null===(b=a.method)|| void 0===b?void 0:b.match(/(POST|PUT|DELETE|PATCH)/))?JSON.stringify(a.body):void 0}),d=await c.json(),e=c.status;e>=200&&e<300?(k(d),l(null),j(d,c)):(h&&k(h),l(!0),i(d))}catch(f){k(void 0),l(new Error(f)),i(f)}finally{m(!1)}}return(React.useEffect(()=>{async function a(){(d||e)&&!f&&(m(!0),n())}if(c>0){let b=setTimeout(a,1e3*c);return()=>clearTimeout(b)}},[c,f,e,d,a]),React.useEffect(()=>{m(!0),n()},[g,c,a]),void 0!==b)?React.createElement(b,{data:d,error:e,loading:f}):null},resolvedRequests={};function FetcherConfig(d){let{children:e,defaults:b={},baseUrl:a,body:f,resolver:g,headers:h,auto:i,memory:j,refresh:k}=d;for(let c in b)resolvedRequests[`${void 0===a?"":a}${c}`]=b[c];return React.createElement(FetcherContext.Provider,{value:{baseUrl:a,body:f,resolver:g,headers:h,auto:i,memory:j,refresh:k}},e)}const useFetcher=(c,j)=>{let a=React.useContext(FetcherContext),{url:d="/",default:k,config:b={baseUrl:void 0,method:"GET",headers:{},body:void 0,formatBody:!1},resolver:v="function"==typeof a.resolver?a.resolver:a=>a.json(),onError:w=()=>{},auto:x=void 0===a.auto||a.memory,memory:l=void 0===a.memory||a.memory,onResolve:y=()=>{},onAbort:m=()=>{},refresh:e=void 0===a.refresh?0:a.refresh,cancelOnChange:z=void 0!==a.refresh&&a.refresh}="string"==typeof c?Object.assign({url:c},j):c,f=(void 0===b.baseUrl?void 0===a.baseUrl?"":a.baseUrl:b.baseUrl)+d,n=f.split("?")[0],[g,o]=React.useState(l&&resolvedRequests[n]||k),[p,A]=React.useState("undefined"!=typeof FormData?b.body instanceof FormData?b.body:void 0!==a.body|| void 0!==b.body?Object.assign(Object.assign({},a.body),b.body):void 0:b.body),[q,B]=React.useState(Object.assign(Object.assign({},a.headers),b.headers)),[r,C]=React.useState(),[s,D]=React.useState(),[h,E]=React.useState(null),[i,F]=React.useState(!0),[t,G]=React.useState(new AbortController);async function H(e={}){var g;z&&(null==t||t.abort());let i=new AbortController;G(i),E(null);try{let a=await fetch(f,{signal:i.signal,method:b.method,headers:Object.assign(Object.assign({"Content-Type":"undefined"!=typeof FormData&&b.body instanceof FormData?"multipart/form-data":"application/json"},b.headers),e.headers),body:(null===(g=b.method)|| void 0===g?void 0:g.match(/(POST|PUT|DELETE|PATCH)/))?"function"==typeof b.formatBody?b.formatBody("undefined"!=typeof FormData&&b.body instanceof FormData?b.body:Object.assign(Object.assign({},b.body),e.body)):!1===b.formatBody||"undefined"!=typeof FormData&&b.body instanceof FormData?b.body:JSON.stringify(Object.assign(Object.assign({},b.body),e.body)):void 0});C(a);let h=a.status;D(h);let c=await v(a);h>=200&&h<400?(l&&(resolvedRequests[n]=c),o(c),E(null),y(c,a)):(k&&o(k),E(!0),w(c,a))}catch(d){let j=null==d?void 0:d.toString();j.match(/abort/i)?resolvedRequests[n]||o(k):(o(void 0),E(new Error(d)),w(d))}finally{F(!1)}}async function u(a={}){a.body&&A(b=>Object.assign(Object.assign({},b),a.body)),a.headers&&B(b=>Object.assign(Object.assign({},b),a.headers)),i||(F(!0),H(a))}return React.useEffect(()=>{let{signal:a}=t||{},b=()=>{let a=setTimeout(()=>{m(),clearTimeout(a)})};return null==a||a.addEventListener("abort",b),()=>{null==a||a.removeEventListener("abort",b)}},[t,m]),React.useEffect(()=>{if(e>0&&x){let a=setTimeout(u,1e3*e);return()=>clearTimeout(a)}},[e,i,h,g,b]),React.useEffect(()=>{x?(F(!0),H()):(o(k),E(null),F(!1))},[d,e,JSON.stringify(b)]),{data:g,loading:i,error:h,code:s,reFetch:u,mutate:o,abort(){t.abort(),i&&(E(!1),F(!1),o(resolvedRequests[n]))},config:Object.assign(Object.assign({},b),{headers:q,body:p,url:f}),response:r}};useFetcher.get=createRequestFn("GET","",{}),useFetcher.delete=createRequestFn("DELETE","",{}),useFetcher.head=createRequestFn("HEAD","",{}),useFetcher.options=createRequestFn("OPTIONS","",{}),useFetcher.post=createRequestFn("POST","",{}),useFetcher.put=createRequestFn("PUT","",{}),useFetcher.patch=createRequestFn("PATCH","",{}),useFetcher.purge=createRequestFn("PURGE","",{}),useFetcher.link=createRequestFn("LINK","",{}),useFetcher.unlink=createRequestFn("UNLINK","",{}),useFetcher.extend=function(d={}){let{baseUrl:b,headers:c={},body:e={},resolver:f}=d;function a(g,j){let a=React.useContext(FetcherContext),h="string"==typeof g?Object.assign({url:g},j):g,{url:k="",config:d={}}=h,i=__rest(h,["url","config"]);return useFetcher(Object.assign(Object.assign({},i),{url:`${k}`,resolver:f||i.resolver||a.resolver||(a=>a.json()),config:{baseUrl:void 0===d.baseUrl?void 0===a.baseUrl?b:a.baseUrl:d.baseUrl,method:d.method,headers:Object.assign(Object.assign(Object.assign({},c),a.headers),d.headers),body:Object.assign(Object.assign(Object.assign({},e),a.body),d.body)}}))}return a.config={baseUrl:b,headers:c,body:e},a.get=createRequestFn("GET",b,c),a.delete=createRequestFn("DELETE",b,c),a.head=createRequestFn("HEAD",b,c),a.options=createRequestFn("OPTIONS",b,c),a.post=createRequestFn("POST",b,c),a.put=createRequestFn("PUT",b,c),a.patch=createRequestFn("PATCH",b,c),a.purge=createRequestFn("PURGE",b,c),a.link=createRequestFn("LINK",b,c),a.unlink=createRequestFn("UNLINK",b,c),a.Config=FetcherConfig,a};const fetcher=useFetcher