/**
 * @license http-react-fetcher
 * Copyright (c) Dany Beltran
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ (()=>{var h=this&&this.__rest||function(b,e){var d={};for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&0>e.indexOf(a)&&(d[a]=b[a]);if(null!=b&&"function"==typeof Object.getOwnPropertySymbols)for(var c=0,a=Object.getOwnPropertySymbols(b);c<a.length;c++)0>e.indexOf(a[c])&&Object.prototype.propertyIsEnumerable.call(b,a[c])&&(d[a[c]]=b[a[c]]);return d};function b(a,b,c,d){return async function(f,q={}){let{default:l,resolver:r=a=>a.json(),config:m={},onResolve:s=()=>{},onError:n=()=>{}}=q,g=Object.assign(Object.assign({},d),m.query),[,t=""]=f.split("?");t.split("&").forEach(c=>{let[a,b]=c.split("=");g[a]!==b&&(g=Object.assign(Object.assign({},g),{[a]:b}))});let o=Object.keys(g).map(a=>[a,g[a]].join("=")).join("&"),{headers:u={},body:h,formatBody:k}=m,i={method:a,headers:Object.assign(Object.assign({"Content-Type":"application/json"},c),u),body:(null==a?void 0:a.match(/(POST|PUT|DELETE|PATCH)/))?"function"==typeof k?k((FormData,h)):!1===k||"undefined"!=typeof FormData&&h instanceof FormData?h:JSON.stringify(h):void 0},j;try{let e=await fetch(`${b||""}${f}${f.includes("?")?`&${o}`:`?${o}`}`,i);j=e;let p=await r(e);if((null==e?void 0:e.status)>=400)return n(!0),{res:e,data:l,error:!0,code:null==e?void 0:e.status,config:Object.assign(Object.assign({url:`${b||""}${f}`},i),{query:g})};return s(p,e),{res:e,data:p,error:!1,code:null==e?void 0:e.status,config:Object.assign(Object.assign({url:`${b||""}${f}`},i),{query:g})}}catch(v){return n(v),{res:j,data:l,error:!0,code:null==j?void 0:j.status,config:Object.assign(Object.assign({url:`${b||""}${f}`},i),{query:g})}}}}let{useState:i,useEffect:j,createContext:c,useContext:k}=React,l=c({defaults:{},attempts:0,attemptInterval:5,revalidateOnFocus:!1,query:{}}),d=({url:g="/",default:h,config:a={method:"GET",headers:{},body:{}},children:b,onError:k=()=>{},onResolve:l=()=>{},refresh:c=0})=>{let[d,m]=i(h),[e,n]=i(null),[f,o]=i(!0);async function p(){var b;try{let c=await fetch(g,{method:a.method,headers:Object.assign({"Content-Type":"application/json"},a.headers),body:(null===(b=a.method)|| void 0===b?void 0:b.match(/(POST|PUT|DELETE|PATCH)/))?JSON.stringify(a.body):void 0}),d=await c.json(),e=c.status;e>=200&&e<300?(m(d),n(null),l(d,c)):(h&&m(h),n(!0),k(d))}catch(f){m(void 0),n(new Error(f)),k(f)}finally{o(!1)}}return(j(()=>{async function a(){(d||e)&&!f&&(o(!0),p())}if(c>0){let b=setTimeout(a,1e3*c);return()=>clearTimeout(b)}},[c,f,e,d,a]),j(()=>{o(!0),p()},[g,c,a]),void 0!==b)?React.createElement(b,{data:d,error:e,loading:f}):null},m={};function e(a){let{children:g,defaults:c={},baseUrl:d}=a,b=k(l),h=void 0===d?void 0===b.baseUrl?"":b.baseUrl:d;for(let e in c)m[`${h}${e}`]=c[e];let f=Object.assign(Object.assign({},b),a);for(let i in a)"headers"===i&&(f.headers=Object.assign(Object.assign({},b.headers),a.headers));return React.createElement(l.Provider,{value:f},g)}let a=(e,s)=>{let a=k(l),{url:c="/",default:t,config:b={query:{},baseUrl:void 0,method:"GET",headers:{},body:void 0,formatBody:!1},resolver:I="function"==typeof a.resolver?a.resolver:a=>a.json(),onError:J=()=>{},auto:K=void 0===a.auto||a.memory,memory:u=void 0===a.memory||a.memory,onResolve:L=()=>{},onAbort:v=()=>{},refresh:f=void 0===a.refresh?0:a.refresh,cancelOnChange:M=void 0!==a.refresh&&a.refresh,attempts:w=a.attempts,attemptInterval:x=a.attemptInterval,revalidateOnFocus:y=a.revalidateOnFocus}="string"==typeof e?Object.assign({url:e},s):e,[d,N]=i(Object.assign(Object.assign({},a.query),b.query));j(()=>{N(Object.assign(Object.assign({},a.query),b.query))},[JSON.stringify(a.query),JSON.stringify(b.query),c]);let n=(void 0===b.baseUrl?void 0===a.baseUrl?"":a.baseUrl:b.baseUrl)+c,o=Object.keys(d).map(a=>[a,d[a]].join("=")).join("&"),z=n+(n.includes("?")?`&${o}`:"?"+o),[p,O]=z.split("?");j(()=>{O.split("&").forEach(a=>{let[b,c]=a.split("=");d[b]!==c&&N(a=>Object.assign(Object.assign({},a),{[b]:c}))})},[JSON.stringify(d)]);let[q,A]=i(u&&m[p]||t),[B,P]=i("undefined"!=typeof FormData?b.body instanceof FormData?b.body:void 0!==a.body|| void 0!==b.body?Object.assign(Object.assign({},a.body),b.body):void 0:b.body),[C,Q]=i(Object.assign(Object.assign({},a.headers),b.headers)),[D,R]=i(),[E,S]=i(),[g,T]=i(null),[h,U]=i(!0),[F,V]=i(0),[G,W]=i(new AbortController);async function X(e={}){var f;M&&(null==G||G.abort());let h=new AbortController;W(h),T(null);try{let a=await fetch(z,{signal:h.signal,method:b.method,headers:Object.assign(Object.assign({"Content-Type":"undefined"!=typeof FormData&&b.body instanceof FormData?"multipart/form-data":"application/json"},b.headers),e.headers),body:(null===(f=b.method)|| void 0===f?void 0:f.match(/(POST|PUT|DELETE|PATCH)/))?"function"==typeof b.formatBody?b.formatBody("undefined"!=typeof FormData&&b.body instanceof FormData?b.body:Object.assign(Object.assign({},b.body),e.body)):!1===b.formatBody||"undefined"!=typeof FormData&&b.body instanceof FormData?b.body:JSON.stringify(Object.assign(Object.assign({},b.body),e.body)):void 0});R(a);let g=a.status;S(g);let c=await I(a);g>=200&&g<400?(u&&(m[p]=c),A(c),T(null),L(c,a),V(0)):(t&&A(t),T(!0),J(c,a))}catch(d){let i=null==d?void 0:d.toString();i.match(/abort/i)?m[p]||A(t):(A(void 0),T(new Error(d)),J(d))}finally{U(!1)}}async function H(a={}){a.body&&P(b=>Object.assign(Object.assign({},b),a.body)),a.headers&&Q(b=>Object.assign(Object.assign({},b),a.headers)),h||(U(!0),X(a))}j(()=>{let{signal:a}=G||{},b=()=>{let a=setTimeout(()=>{v(),clearTimeout(a)})};return null==a||a.addEventListener("abort",b),()=>{null==a||a.removeEventListener("abort",b)}},[G,v]),j(()=>{Q(b=>Object.assign(Object.assign({},b),a.headers))},[a.headers]),j(()=>{if(g&&F<w){let a=setTimeout(()=>{H(),V(a=>a+1),clearTimeout(a)},1e3*x)}},[g,w,x,F]),j(()=>{if(f>0&&K){let a=setTimeout(H,1e3*f);return()=>clearTimeout(a)}},[f,h,g,q,b]);let r=JSON.stringify(Object.assign(a,{children:void 0},{resolver:void 0},{reqQuery:d}));return j(()=>{let a=setTimeout(()=>{K?(U(!0),X()):(void 0===q&&A(t),T(null),U(!1))},0);return()=>{clearTimeout(a)}},[c,r,a.children,f,JSON.stringify(b)]),j(()=>{if(y&&"undefined"!=typeof window&&"addEventListener"in window)return window.addEventListener("focus",H),()=>{window.removeEventListener("focus",H)}},[c,y,r,h,a.children,f,JSON.stringify(b),]),{data:q,loading:h,error:g,code:E,reFetch:H,mutate:A,abort(){G.abort(),h&&(T(!1),U(!1),A(m[p]))},config:Object.assign(Object.assign({},b),{headers:C,body:B,url:p,query:d}),response:D}};a.get=b("GET","",{}),a.delete=b("DELETE","",{}),a.head=b("HEAD","",{}),a.options=b("OPTIONS","",{}),a.post=b("POST","",{}),a.put=b("PUT","",{}),a.patch=b("PATCH","",{}),a.purge=b("PURGE","",{}),a.link=b("LINK","",{}),a.unlink=b("UNLINK","",{}),a.extend=function(i={}){let{baseUrl:d,headers:f={},body:j={},query:g={},resolver:m}=i;function c(e,n){let b=k(l),g="string"==typeof e?Object.assign({url:e},n):e,{url:o="",config:c={}}=g,i=h(g,["url","config"]);return a(Object.assign(Object.assign({},i),{url:`${o}`,resolver:m||i.resolver||b.resolver||(a=>a.json()),config:{baseUrl:void 0===c.baseUrl?void 0===b.baseUrl?d:b.baseUrl:c.baseUrl,method:c.method,headers:Object.assign(Object.assign(Object.assign({},f),b.headers),c.headers),body:Object.assign(Object.assign(Object.assign({},j),b.body),c.body)}}))}return c.config={baseUrl:d,headers:f,body:j,query:g},c.get=b("GET",d,f,g),c.delete=b("DELETE",d,f,g),c.head=b("HEAD",d,f,g),c.options=b("OPTIONS",d,f,g),c.post=b("POST",d,f,g),c.put=b("PUT",d,f,g),c.patch=b("PATCH",d,f,g),c.purge=b("PURGE",d,f,g),c.link=b("LINK",d,f,g),c.unlink=b("UNLINK",d,f,g),c.Config=e,c};let f=a,n={headers:{},body:void 0};class o{constructor(a){this.baseUrl="",this.baseUrl=a}async get(b,{headers:c,body:a}=n,d="GET"){let e=`${this.baseUrl}${b}`,f=await fetch(e,Object.assign({method:d,headers:Object.assign({"Content-Type":"application/json",Accept:"application/json"},c)},a?{body:JSON.stringify(a)}:{})),g=await f.json();return g}async post(a,b=n){return await this.get(a,b,"POST")}async put(a,b=n){return await this.get(a,b,"PUT")}async delete(a,b=n){return await this.get(a,b,"DELETE")}}function g(a){return new o(a)}window.Fetcher=d,window.useFetcher=a,window.createHttpClient=g,window.FetcherConfig=e,window.fetcher=f})()